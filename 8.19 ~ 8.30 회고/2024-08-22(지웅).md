# ğŸ“ 2024.08.22 íšŒê³  ğŸ“
#### 1. ìˆ˜ì—… ë‚´ìš© ë³µìŠµì •ë¦¬

------
------

$ ì˜¤ëŠ˜ í•œ í•µì‹¬ë‚´ìš©ë“¤ ì •ë¦¬

## 1. ê¸€ ìƒì„¸ í˜ì´ì§€ êµ¬í˜„
- Postì— ëŒ€í•œ ìƒì„¸ í˜ì´ì§€ë¥¼ êµ¬í˜„í•˜ê³ , í…œí”Œë¦¿ì˜ ì¤‘ë³µ ì½”ë“œë¥¼ ì œê±°í•˜ì—¬ ë¦¬íŒ©í† ë§ì„ ì§„í–‰í•˜ì˜€ìŒ

#### 1.1 ê¸°ë³¸ êµ¬ì¡° êµ¬í˜„
- View: posts/views.py
- URL: /posts/<int:post_id>/
- Template: templates/posts/post_detail.html

```
# posts/views.py
def post_detail(request, post_id):
    post = Post.objects.get(id=post_id)
    context = {"post": post}
    return render(request, "posts/post_detail.html", context)

# posts/urls.py
from posts.views import post_detail

urlpatterns = [
    path("<int:post_id>/", post_detail, name="post_detail"),
]

<!-- templates/posts/post_detail.html -->
{% extends 'base.html' %}

{% block content %}
<div id="feeds" class="post-container">
    <article id="post-{{ post.id }}" class="post">
        <!-- Post content here -->
    </article>
</div>
{% endblock %}
```
##### Post ìƒì„¸ í˜ì´ì§€ë¥¼ ìœ„í•œ ê¸°ë³¸ êµ¬ì¡°ë¥¼ êµ¬í˜„í•˜ì˜€ê³ , post_detail ë·°ì—ì„œ íŠ¹ì • Postë¥¼ ê°€ì ¸ì™€ì„œ í…œí”Œë¦¿ì— ì „ë‹¬í•˜ë©°, í•´ë‹¹ Postì˜ ë‚´ìš©ì„ í‘œì‹œí•˜ì˜€ë‹¤.

#### 1.2 í…œí”Œë¦¿ ì¤‘ë³µ ì œê±°
- <article> íƒœê·¸ ë¶€ë¶„ì„ ë³„ë„ì˜ í…œí”Œë¦¿(post.html)ìœ¼ë¡œ ë¶„ë¦¬í•˜ì—¬ ì¬ì‚¬ìš©.
- ë„¤ë¹„ê²Œì´ì…˜ ë°”(<nav>)ë„ ë³„ë„ì˜ í…œí”Œë¦¿(nav.html)ìœ¼ë¡œ ë¶„ë¦¬.


```
<!-- templates/posts/post.html -->
<article id="post-{{ post.id }}" class="post">
    <!-- Reusable Post content -->
</article>

<!-- templates/posts/feeds.html -->
{% extends 'base.html' %}
{% block content %}
{% include 'nav.html' %}
<div id="feeds" class="post-container">
    {% for post in posts %}
        {% include 'posts/post.html' %}
    {% endfor %}
</div>
{% endblock %}

<!-- templates/posts/post_detail.html -->
{% extends 'base.html' %}
{% block content %}
{% include 'nav.html' %}
<div id="feeds" class="post-container">
    {% include 'posts/post.html' %}
</div>
{% endblock %}
```
##### í…œí”Œë¦¿ì˜ ì¤‘ë³µëœ ì½”ë“œë¥¼ ì œê±°í•˜ê¸° ìœ„í•´, ë°˜ë³µì ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” <article> íƒœê·¸ì™€ ë„¤ë¹„ê²Œì´ì…˜ ë°”ë¥¼ ê°ê° post.htmlê³¼ nav.htmlë¡œ ë¶„ë¦¬í•˜ì—¬ ìœ ì§€ë³´ìˆ˜ì„±ì„ ë†’ì´ëŠ” ì‘ì—…ì„ ì§„í–‰


## 2. ì¢‹ì•„ìš” ê¸°ëŠ¥ êµ¬í˜„
- ì‚¬ìš©ìê°€ Postì— ëŒ€í•´ "ì¢‹ì•„ìš”"ë¥¼ ëˆ„ë¥¼ ìˆ˜ ìˆë„ë¡ ê¸°ëŠ¥ì„ êµ¬í˜„í•©ë‹ˆë‹¤.

## 2.1 ì¢‹ì•„ìš” í† ê¸€ ê¸°ëŠ¥
- View: posts/views.py
  
```
# posts/views.py
def post_like(request, post_id):
    post = Post.objects.get(id=post_id)
    user = request.user

    if user.like_posts.filter(id=post.id).exists():
        user.like_posts.remove(post)
    else:
        user.like_posts.add(post)

    url_next = request.GET.get("next") or reverse("posts:feeds") + f"#post-{post.id}"
    return HttpResponseRedirect(url_next)

# posts/urls.py
urlpatterns = [
    path("<int:post_id>/like/", post_like, name="post_like"),
]

# Template ë³€ê²½: post.htmlì— ì¢‹ì•„ìš” ë²„íŠ¼ ì¶”ê°€
<!-- templates/posts/post.html -->
<div class="post-buttons">
    <form action="{% url 'posts:post_like' post.id %}?next={{ action_redirect_url }}" method="POST">
        {% csrf_token %}
        <button type="submit"
            {% if user in post.like_users.all %}
                style="color: red;"
            {% endif %}>
            Likes({{ post.like_users.count }})
        </button>
    </form>
    <span>Comments({{ post.comment_set.count }})</span>
</div>
```

##### ì¢‹ì•„ìš” ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ post_like ë·°ê°€ í˜¸ì¶œë˜ì–´, ì´ë¯¸ ì¢‹ì•„ìš”ë¥¼ ëˆ„ë¥¸ ìƒíƒœë¼ë©´ í•´ì œí•˜ê³ , ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ ì¢‹ì•„ìš”ë¥¼ ì¶”ê°€ 
##### ë²„íŠ¼ì€ í˜„ì¬ ì‚¬ìš©ìê°€ í•´ë‹¹ Postë¥¼ ì¢‹ì•„ìš” í–ˆëŠ”ì§€ì— ë”°ë¼ ìŠ¤íƒ€ì¼ì´ ë³€ê²½ë˜ì–´ì§„ë‹¤.


## 3. íŒ”ë¡œìš°/íŒ”ë¡œì‰ ê¸°ëŠ¥ êµ¬í˜„
- ì‚¬ìš©ìê°€ ë‹¤ë¥¸ ì‚¬ìš©ìë“¤ì„ íŒ”ë¡œìš°í•˜ê±°ë‚˜ íŒ”ë¡œì‰í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì„ êµ¬í˜„

## 3.1 íŒ”ë¡œìš° ê´€ê³„ ëª¨ë¸
- Model: users/models.py
```
# users/models.py
class Relationship(models.Model):
    from_user = models.ForeignKey(User, related_name="following_relationships", on_delete=models.CASCADE)
    to_user = models.ForeignKey(User, related_name="follower_relationships", on_delete=models.CASCADE)
    created = models.DateTimeField(auto_now_add=True)

class User(AbstractUser):
    following = models.ManyToManyField('self', through='Relationship', related_name="followers", symmetrical=False)
```

##### Relationship ëª¨ë¸ì„ í†µí•´ ì‚¬ìš©ì ê°„ì˜ íŒ”ë¡œìš°/íŒ”ë¡œì‰ ê´€ê³„ë¥¼ ê´€ë¦¬í•˜ë©°, User ëª¨ë¸ì€ following í•„ë“œë¥¼ í†µí•´ ìì‹ ì´ íŒ”ë¡œìš°í•˜ëŠ” ì‚¬ìš©ìë“¤ì„ ê°€ì ¸ì˜¬ ìˆ˜ ìˆê²Œí•¨

## 3.2 í”„ë¡œí•„ í˜ì´ì§€
- View: users/views.py
- 
```
# users/views.py
def profile(request, user_id):
    user = get_object_or_404(User, id=user_id)
    context = {"user": user}
    return render(request, "users/profile.html", context)
```

- Template: templates/users/profile.html
```
<!-- templates/users/profile.html -->
{% extends 'base_nav.html' %}

{% block content %}
<div id="profile">
    <div class="info">
        {% if user.profile_image %}
            <img src="{{ user.profile_image.url }}">
        {% endif %}
        <div class="info-texts">
            <h1>{{ user.username }}</h1>
            <div class="counts">
                <dl>
                    <dt>Posts</dt>
                    <dd>{{ user.post_set.count }}</dd>
                    <dt>Followers</dt>
                    <dd>{{ user.followers.count }}</dd>
                    <dt>Following</dt>
                    <dd>{{ user.following.count }}</dd>
                </dl>
            </div>
            <p>{{ user.short_description }}</p>
        </div>
    </div>
    <div class="post-grid-container">
        {% for post in user.post_set.all %}
            {% if post.postimage_set.first %}
                <div class="post-grid">
                    <a href="{% url 'posts:post_detail' post.id %}">
                        <img src="{{ post.postimage_set.first.photo.url }}">
                    </a>
                </div>
            {% endif %}
        {% endfor %}
    </div>
</div>
{% endblock %}
```
##### í”„ë¡œí•„ í˜ì´ì§€ì—ì„œ ì‚¬ìš©ìì˜ ê¸°ë³¸ ì •ë³´(ê²Œì‹œë¬¼ ìˆ˜, íŒ”ë¡œì›Œ ìˆ˜, íŒ”ë¡œì‰ ìˆ˜)ë¥¼ í‘œì‹œí•˜ê³ , ì‚¬ìš©ìê°€ ì‘ì„±í•œ ê²Œì‹œë¬¼ ëª©ë¡ì„ ê·¸ë¦¬ë“œ í˜•ì‹ìœ¼ë¡œ ë³´ì—¬ì£¼ì—ˆë‹¤.


í”„ë¡œí•„ ì¶”ê°€ (í¬ìŠ¤íŠ¸, íŒ”ë¡œìš°, íŒ”ë¡œì‰ ì¶”ê°€)
![image](https://github.com/user-attachments/assets/dd05ebd9-953d-42d1-9762-cc714d7fda49)

ì¢‹ì•„ìš” ê¸°ëŠ¥ ì¶”ê°€, ëŒ“ê¸€ ìˆ˜ ì¶” ì¹´ìš´íŒ… ì¶”ê°€
![image](https://github.com/user-attachments/assets/54464e5b-f11c-4b3d-a86b-f50cf02ef623)
